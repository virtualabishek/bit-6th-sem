That's the interactive spirit! Before we dive deep into Privileges and Roles, let's quickly check your solution for the `LEGACY_APP` scenario, as mastering session and user cleanup is critical for the practical exam:

### **Solution Check: Dropping `LEGACY_APP`**

Since you cannot drop a user who is currently connected to the database, and the user owns objects (tables, etc.), the two necessary SQL commands are:

1.  **Terminate the Session:**
    ```sql
    ALTER SYSTEM KILL SESSION '150, 3000';
    ```
    (This ensures the user is logged out.)
2.  **Drop the User and Objects:**
    ```sql
    DROP USER LEGACY_APP CASCADE;
    ```
    (The `CASCADE` keyword is mandatory here, as it drops all objects owned by `LEGACY_APP` and then drops the user.)

Great job! Let's now focus entirely on Unit 3.1: **Managing Privileges, Roles, and Access**.

---

## Unit 3.1: Managing Privileges & Roles (Theory and Practical Code)

### I. Privilege Hierarchy: System vs. Object

Database security relies on controlling the actions a user can perform (privileges). A user account (schema) is a logical grouping of database objects owned by that user.

| Privilege Type | Definition | Scope | Example SQL Statement |
| :--- | :--- | :--- | :--- |
| **System Privilege** | The right to perform a specific action across the entire database or on any schema object of a particular type. | Database-wide. | `CREATE USER`, `CREATE TABLE`, `SELECT ANY TABLE`. |
| **Object Privilege** | The right to perform a specific action on a single, named schema object (e.g., a table, view, or procedure). | Specific object/schema. | `SELECT ON HR.EMPLOYEES`, `EXECUTE ON PACKAGE_A`. |

### II. System Privileges and Control

To grant any privilege, the granting user must have the privilege **with the `ADMIN OPTION`** or hold the `GRANT ANY PRIVILEGE` system privilege.

#### A. Granting System Privileges (Core Code)
To grant access to the database, the user must have at least the `CREATE SESSION` privilege.

```sql
-- 1. Granting the basic connection right:
GRANT CREATE SESSION TO USER_JONES;

-- 2. Granting the right to create tables in their own schema:
GRANT CREATE TABLE TO USER_JONES;

-- 3. Granting a privilege with the power to re-grant it (ADMIN OPTION):
GRANT CREATE USER TO DBA_JR WITH ADMIN OPTION; 
-- DBA_JR can now grant CREATE USER to others.
```

#### B. Revoking System Privileges (Core Code)
Use the `REVOKE` statement.

```sql
-- Revoking the privilege to create tables from the user
REVOKE CREATE TABLE FROM USER_JONES;
```

### III. Object Privileges and Control

The owner of an object has all privileges on that object.

#### A. Granting Object Privileges (Core Code)
You must specify the object name along with the privilege (e.g., `SELECT`, `INSERT`, `UPDATE`, `DELETE`, `EXECUTE`).

```sql
-- 1. Granting DML privileges on the EMPLOYEES table (owned by HR) to USER_JONES:
GRANT SELECT, INSERT, DELETE ON HR.EMPLOYEES TO USER_JONES;

-- 2. Granting the right to pass on the privilege (WITH GRANT OPTION):
GRANT UPDATE ON HR.EMPLOYEES TO USER_JONES WITH GRANT OPTION;

-- 3. Granting privileges only on specific columns:
GRANT INSERT (first_name, last_name) ON HR.EMPLOYEES TO USER_JONES;
```

#### B. Revoking Object Privileges (Core Code)

```sql
-- 1. Revoking SELECT and INSERT privileges:
REVOKE SELECT, INSERT ON HR.EMPLOYEES FROM USER_JONES;

-- 2. Revoking ALL granted object privileges (caution: includes privileges granted by object owner):
REVOKE ALL ON HR.EMPLOYEES FROM USER_JONES;

-- 3. Revoking the REFERENCES privilege, forcing deletion of dependent foreign keys:
REVOKE REFERENCES ON DEPT FROM JWARD CASCADE CONSTRAINTS;
```

### IV. Managing Roles (Logical Grouping)

A role is a named set of privileges used to simplify administration.

| Action | SQL Command Syntax | Notes | Source |
| :--- | :--- | :--- | :--- |
| **Create Role** | `CREATE ROLE HR_APP_MANAGER;` | Default is `NOT IDENTIFIED` (no password). | |
| **Create Role (Authenticated)** | `CREATE ROLE SEC_AUDIT_ROLE IDENTIFIED BY Pwd123;` | Requires a password to enable via `SET ROLE`. | |
| **Grant Privileges to Role** | `GRANT CREATE TABLE, SELECT ANY SEQUENCE TO HR_APP_MANAGER;` | Roles can contain system and object privileges. | |
| **Grant Role to User** | `GRANT HR_APP_MANAGER TO USER_JONES;` | This grants all privileges contained in the role. | |
| **Alter Role (Change Auth)** | `ALTER ROLE SEC_AUDIT_ROLE NOT IDENTIFIED;` | Changes the authentication method. | |
| **Drop Role** | `DROP ROLE HR_APP_MANAGER;` | Role is immediately removed from all users who were granted it. | |

### V. Oracle Supplied Roles (Predefined Roles)

Oracle creates several predefined roles that bundle common privileges.

| Role Name | Description/Purpose | Key Privileges | Source |
| :--- | :--- | :--- | :--- |
| **CONNECT** | Provides the ability to connect to the database. | Grants the `CREATE SESSION` system privilege. | |
| **RESOURCE** | Grants the ability to create objects in the user's own schema (for developers). | Grants `CREATE TABLE`, `CREATE SEQUENCE`, `CREATE PROCEDURE`, etc., but explicitly **does not** include `UNLIMITED TABLESPACE` in modern versions. | |
| **DBA** | The most powerful predefined role, granting broad administrative powers. | Grants nearly all system privileges (including `ANY` privileges) with the `ADMIN OPTION`. It does not include privileges to start/shut down the database instance. | |
| **SELECT\_CATALOG\_ROLE** | Grants `SELECT` privilege on the data dictionary views and tables. | Useful for monitoring and reporting tasks. | |
| **EXECUTE\_CATALOG\_ROLE** | Grants `EXECUTE` privilege on Oracle-supplied packages and procedures in the data dictionary. | Used to execute procedures owned by the `SYS` schema. | |

---

## Exam Practice Question (Qn Asked from this Unit)

Here is a typical exam question that combines multiple concepts from the privileges unit:

**Question:**

A new application owner, `APP_DEV`, needs to be set up. You must grant them the minimum necessary rights to build and manage their application objects.

1.  Write the SQL command to create the user `APP_DEV` authenticated by the password `P@ss123`.
2.  Write the SQL statement to grant `APP_DEV` the privileges required to log in and create tables, views, and procedures *in their own schema* using the most relevant predefined roles.
3.  `APP_DEV` must allow a report-generating user, `REP_USER`, to read data from their `ORDERS` table and also grant that `REP_USER` the ability to pass this `SELECT` privilege to other users. Write the single SQL statement `APP_DEV` must execute to achieve this.

Ready for your answer?