That’s an essential topic for performance and system stability! Unit 6.1 focuses on the automatic tools Oracle provides to maintain and diagnose the database, shifting the DBA's role to more proactive management.

Let's start by addressing the core components of maintenance and monitoring.

### **Unit 6.1: Database Maintenance and Performance Management**

#### **I. Database Maintenance Overview (Theory)**

Database Maintenance is the ongoing process of managing and optimizing a database to ensure data integrity, performance, and availability. It involves activities such as monitoring, backup, recovery, indexing, performance tuning, and error checking.

Key aspects of maintenance include:
1.  **Regular Backup and Recovery** to prevent data loss from hardware failures or corruption.
2.  **Database Monitoring** of storage, performance, and issue tracking using tools like Oracle Enterprise Manager (OEM).
3.  **Applying Updates and Patches** to fix bugs, security risks, and performance issues.
4.  **Cleaning Up Old Data** by deleting or archiving data to keep the database efficient.

#### **II. Viewing the Alert Log**

The **Alert Log** is a special log file that records important database events, warnings, and critical errors. DBAs use it to monitor the database's health and performance.

| Method | Description | Source |
| :--- | :--- | :--- |
| **OS File** | The log is stored as a file on the server. You can open it directly using a text viewer. The file is located in the `$ADR_HOME/trace` directory, which can be found by querying `V$DIAG_INFO` where `name = 'Diag Trace'`. | |
| **ADRCI** | The **Automatic Diagnostic Repository Command Interpreter (ADRCI)** utility can be used to view the alert log contents. You can use `SHOW ALERT -TAIL N` to see the last *N* lines. | |
| **SQL** | You can query the alert log via SQL using an external table definition or by querying views like `V$DIAG_ALERT_EXT`. | |
| **EM Express** | You can check the alert log with a graphical interface by logging into Oracle Enterprise Manager and viewing the **Alert log** or **logs** section. | |

#### **III. Automatic Workload Repository (AWR)**

The AWR is a key automatic performance tuning feature. It collects, processes, and maintains performance statistics for problem detection and self-tuning. This data is stored both in memory and in the database.

*   **Snapshots:** AWR collects performance data by taking **snapshots** regularly, by default **once every hour**. Snapshots are sets of historical data used by ADDM for comparison.
*   **Data Retention:** By default, AWR retains statistics for **8 days**. A longer retention period increases space consumption. If reducing the retention period, note that ADDM, SQL Tuning Advisor, Undo Advisor, and Segment Advisor depend on AWR data for accurate functioning.
*   **Location:** Snapshots are stored in the `SYSAUX` tablespace.
*   **Reports:** An AWR report shows data captured between two snapshots (points in time). You can generate reports using SQL scripts like `@$ORACLE_HOME/rdbms/admin/awrrpt.sql`.

#### **IV. Statistic Levels**

The amount of data collected by the database is controlled by the `STATISTICS_LEVEL` initialization parameter. To enable automatic statistics collection and automatic performance features, this parameter must be set to `TYPICAL` or `ALL`.

| Level | Description | ADDM/AWR | Source |
| :--- | :--- | :--- | :--- |
| **BASIC** | Collects only basic information (like database activity and user sessions). Monitoring and many automatic features are disabled. **Not recommended**. | Disabled | |
| **TYPICAL** | The default setting. Includes everything in BASIC plus detail on individual SQL queries and execution. Provides the best balance for optimizing performance without excessive overhead. | Enabled | |
| **ALL** | Collects everything from the `TYPICAL` level, plus detailed diagnostics about SQL statements. Useful for deep performance analysis, but consumes more resources. | Enabled | |

#### **V. Automatic Database Diagnostic Monitor (ADDM)**

ADDM is a tool that automatically analyzes performance data stored in the AWR. Its primary goal is to diagnose the root causes of performance problems and provide recommendations for correction.

*   **Operation:** ADDM runs its analysis whenever an AWR snapshot is taken (hourly by default).
*   **Target:** The goal of ADDM is to reduce **DB time** (cumulative time spent processing user requests, including wait and CPU time of non-idle sessions).
*   **Findings:** ADDM provides findings (problems, symptoms, information, warnings) and recommendations that suggest solutions like hardware changes, configuration changes, or using other advisors.
*   **Real-Time ADDM:** This newer feature proactively detects and diagnoses transient, high-impact problems like hangs, deadlocks, and high CPU spikes in real time.

#### **VI. Use the Advisors**

Oracle provides a suite of **Advisors**—powerful tools that analyze various aspects of the database and provide specific advice to address key management challenges, such as performance, space, and undo management.

| Advisor | Purpose/Function | Source |
| :--- | :--- | :--- |
| **ADDM** | Diagnoses system performance, identifies bottlenecks (e.g., lock contention, high CPU), and recommends solutions. | |
| **SQL Tuning Advisor** | Analyzes problematic SQL statements and recommends optimizations (e.g., statistics collection, indexing, query restructuring). It can be run automatically or manually. | |
| **Memory Advisors** | Provide "what-if" analysis and graphical reports on the impact of changing memory structures like the SGA and PGA on performance. | |
| **Undo Advisor** | Relies on AWR data to estimate the necessary size of the undo tablespace and recommend retention settings. | |

#### **VII. Set Up Notification Rules**

DBAs use notifications (alerts) to warn them when something important happens, such as high CPU usage or low memory/storage.

*   **Mechanism:** Notifications/alerts can be set up via **Oracle Enterprise Manager (OEM)**.
*   **Viewing Incidents:** Critical errors, or **incidents**, are reported in the **Incidents - Last 24 Hours** section of the EM Express Database Home page. Each incident is recorded in the Automatic Diagnostic Repository (ADR), which is located outside the database.

---

### **Practice Question Check (Audit/Profiles Review)**

Let's quickly wrap up the previous question to keep your momentum going before the exam!

**Question:** If `AUDITOR_LTD` needs the ability to review all audit data and purge old records, which specific role must they be granted, and what is the single SQL command to assign it?

1.  **Review Audit Data:** Which role provides **read/write** access to audit settings and trails?
2.  **SQL Command:** How do you grant this role to `AUDITOR_LTD`?
